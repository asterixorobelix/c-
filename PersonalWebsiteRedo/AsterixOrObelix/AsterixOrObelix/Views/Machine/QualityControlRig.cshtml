
@{
    ViewBag.Title = "QualityControlRig";
}

<div class="container">

    <h2 style="font-family: Lobster, Monospace">QualityControlRig</h2>
    <p class="lead" style="text-align:center">An automated rig for testing salt and pepper grinders</p>

    <figure class="text-center">
        <img src="https://drive.google.com/uc?export=view&id=0B822K1X9crfFT3ZSdTl6T3p6VGM" class="img-responsive img-rounded img-thumbnail" alt="Completed factory rig">
        <figcaption class="figure-caption text-center">Completed factory rig</figcaption>
    </figure>

    <p>I built a rig which used a Raspberry Pi (RPi), motor and a rotary encoder. Using a Raspberry Pi allowed for the machine to have a screen, keyboard and mouse. 
    The machine works by reading signals from a rotary encoder attached to the motor shaft. The software can then work out how many degrees the motor shaft has turned. 
    When the target number of revolutions has been reached, a light comes on in order to signal that the target has been reached.</p>

    <figure class="text-center">
        <img src="https://drive.google.com/uc?export=view&id=0B822K1X9crfFdzlSXy14SFZRLWM" class="figure-img img-thumbnail img-responsive center-block" alt="3.3 V circuit diagram" width="50%">
        <figcaption class="figure-caption text-center">3.3 V circuit diagram</figcaption>
    </figure>


    <figure class="text-center">
        <img src="https://drive.google.com/uc?export=view&id=0B822K1X9crfFVzhvN1JueVlGNnM" class="figure-img img-thumbnail img-responsive center-block" alt="5 V circuit diagram" width="40%">
        <figcaption class="figure-caption text-center">5 V circuit diagram</figcaption>
    </figure>


    <p>
        Completing this project allowed me to gain a better understanding of certain components:
    </p>
    <h3 class="text-center">Optical, incremental rotary encoder</h3>
    <p>
        The rotary encoder outputs two signals, amusingly called signal A and signal B. Signal A and B are out of phase. As a result, at certain points during the cycle, signal A is high (logic 1) and signal B is low (logic 0). 
        By interpreting the strings of 00, 01, 11 etc; one can work out direction of travel and speed of rotation. This particular encoder provides 100 pulses per 360 degree revolution.
    </p>
    <p>
        <table align="center">
            <thead>
                <tr>
                    <th colspan="3">Coding for clockwise rotation</th><!-- <th colspan = "#colums">text</th> -->
                </tr>
                <tr>
                    <th class="text-center">Phase</th>
                    <th>A</th>
                    <th >B</th>
                </tr>
            </thead>
            <tbody>
                <tr  >
                    <td class="text-center">1</td>
                    <td>0</td>
                    <td>0</td>
                </tr>
                <tr >
                    <td class="text-center">2</td>
                    <td>0</td>
                    <td>1</td>
                </tr>
                <tr >
                    <td class="text-center">3</td>
                    <td>1</td>
                    <td>1</td>
                </tr>
                <tr >
                    <td class="text-center">4</td>
                    <td>1</td>
                    <td>0</td>
                </tr>
            </tbody>
        </table>
    </p>

    
    <figure class="text-center">
        <img src="https://drive.google.com/uc?export=view&id=0B822K1X9crfFMk9IOTlpX2lTS0E" class="figure-img img-thumbnail img-responsive center-block" alt="Quadratures" width="50%">
        <figcaption class="figure-caption text-center">Quadratures</figcaption>
    </figure>
    
    <p>
        The on/off signal is generated by breaking a beam of light when a disk, similar to the one below spins inside the rotary encoder.
    </p>

    <figure class="text-center">
        <img src="https://drive.google.com/uc?export=view&id=0B822K1X9crfFN3F2TTZScm9yNW8" class="figure-img img-thumbnail img-responsive center-block" alt="Three bit rotary encoder" width="20%">
        <figcaption class="figure-caption text-center" >Three bit rotary encoder</figcaption>
    </figure>

    <p>The image above is for a 3 bit encoder, not the two bit encoder which I have been talking about so far.</p>

    <p>The rotary encoder requires 12 V DC to operate. When a signal of high is given on one of the channel, it outputs 12 V DC. 
    Hence, the need to use a voltage divider circuit to drop the signal voltage to 3.3 V DC; points 1 and 2 in the 12 V diagram. 
    This means that the signal can be received by the RPi, without frying the RPi. Voltage at points 1 and 2 can be calculated with the following equation: Vout =(R2/R1+R2)*Vin
    </p>
    <h3 class="text-center">Relay board</h3>
    <p>
        The relay board is relatively simple, you provide it with ground and 5 V and then switch the Normally Closed (NC) or Normally Open (NO) contacts with a low signal from the microcontroller. 
        This particular relay board is capable of switching 250 V AC at 10 A on the high power side. The high power side will drive a 3 phase motor through a contactor.
    </p>
    <p>
        <h3 class="text-center">10 W LED</h3>
    <p>
        In a factory environment, a normal breadboard LED will not easily be seen. So, it was decided to use a high power, 10 W LED to signal to the user. 
        The LED generates so much heat, that a heatsink is required to prevent the LED from burning out. An IRF510 power MOSFET was used to switch the 12 V, 1 A supply to the LED. 
        The N channel MOSFET has 3 pins; a gate, drain and a source.
    </p>

    <figure class="text-center">
        <img src="https://drive.google.com/uc?export=view&id=0B822K1X9crfFS2dNekl4czB0ejA" class="figure-img img-thumbnail img-responsive center-block" alt="Pin layout for N channel MOSFET" width="20%">
        <figcaption class="figure-caption text-center">Pin layout for N channel MOSFET</figcaption>
    </figure>

    <figure class="text-center">
        <img src="https://drive.google.com/uc?export=view&id=0B822K1X9crfFSXpGakh4bmlJR0E" class="figure-img img-thumbnail img-responsive center-block" alt="MOSFET microcontroller connection" width="50%">
        <figcaption class="figure-caption text-center">MOSFET microcontroller connection</figcaption>
    </figure>

    <p>
        The Gate pin receives microcontroller signals, the source receives Ground, the Drain supplies Ground voltage from the source pin (closing the circuit for the LED).
    </p>
    <h3 class="text-center">Software</h3>
    <p>
        Code for the microcontroller was written in Python.
        A brief description of the code structure is as follows:
        <ol>
            <li>You double click on icon</li>
            <li>Displays settings from last session (Forward Degrees and Forward Cycles)</li>
            <li>Do you want to reload these settings?</li>
            <li>If yes. It reloads settings saved in a text file on the RPi SD card. If no, you enter values for Forward Degrees and Forward Cycles.</li>
            <li>Waits for user to press s on keyboard to start program</li>
            <li>Displays current cycle (as opposed to target Forward Cycles)</li>
            <li>Switches motor on in Forward direction.</li>
            <li>Checks rotary encoder until target Forward Degrees reached.</li>
            <li>waits 3 seconds</li>
            <li>Runs through from 6-9 until target number of Forward Cycles reached</li>
            <li>Sends notification email to the user.</li>
            <li>Exits program, leaving an LED on, to signal that target number of Forward Cycles has been reached.</li>
        </ol>
    <p>
        A great deal of time was spent trying to make an icon on the desktop which, when double clicked, ran the code. However, questions on various Linux forums did not yield much success.
        At some stage, I plan on going back to the code and making a more user-friendly interface with the Tkinter python GUI module. 
        Currently, the code gets input from the user via the Terminal, which is not the most user-friendly interface.
    </p>

    <figure class="text-center">
        <img src="https://drive.google.com/uc?export=view&id=0B822K1X9crfFT3ZSdTl6T3p6VGM" class="figure-img img-thumbnail img-responsive center-block" alt="Completed factory rig" " width="50%">
        <figcaption class="figure-caption text-center">Completed factory rig</figcaption>
    </figure>



    <figure class="text-center">

        <img src="https://drive.google.com/uc?export=view&id=0B822K1X9crfFRUdpMjVjQjNGc2M" class="figure-img img-thumbnail img-responsive center-block" alt="Completed factory rig" " width="50%">
        <figcaption class="figure-caption text-center">Close up view of completed factory rig</figcaption>
    </figure>
    
</div><!--/container-->

